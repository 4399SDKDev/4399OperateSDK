# 4399运营SDK升级日志

----

## SDK v2.36.2.197
发布日期：__2020-01-29__

* 不再强制开发者申请“发送短信”权限
* 处理延迟优惠券列表失败请求
* 添加应用是否在前台健壮性判断

## SDK v2.36.1.196
发布日期：__2020-01-22__

* 优化部分机型QQ充值订单客户端状态错误
* 修复获取旧版本数据类型异常问题
* 修复偶现getRunningAppProcesses空指针问题
* 修复偶现创建横幅BadTokenException问题

## SDK v2.36.0.190
发布日期：__2020-01-06__

* 新增登录防刷功能
* 新增通用优惠券
* 新增微信、QQ支付渠道订单状态查询
* UI风格改版
* 重构登录、充值、个人中心等功能
* 修复猜你喜欢跳转游戏盒问题
* 新增优惠券抢券功能

## SDK v2.36.0.188
发布日期：__2020-12-30__

* 新增登录防刷功能
* 新增通用优惠券
* 新增微信、QQ支付渠道订单状态查询
* UI风格改版
* 重构登录、充值、个人中心等功能
* 修复初次使用短代支付功能闪退

## SDK v2.36.0
发布日期：__2020-12-29__ 

* 新增登录防刷功能
* 新增通用优惠券
* UI风格改版
* 重构登录、充值、个人中心等功能

## SDK v2.34.1.6
发布日期：__2020-11-17__ 

* 新增优惠券防刷功能
* 新增登录反馈入口
* 新增前往游戏盒接口
* 修复登录、悬浮球功能空指针问题

## SDK v2.34.0.12
发布日期：__2020-09-03__ 

* 新增海外实名认证入口
* 新增智能客服功能
* 优惠券功能改版

## SDK v2.32.1.1
发布日期：__2020-06-15__ 

* 优化实名认证相关模块支持输入小写x
* 修复一键登录关联账号过多导致登录死循环
* 修复游戏方反馈的偶现闪退(后台闪退日志)
* 修复论坛页面点击下载游戏盒没有反应

## SDK v2.32.0.12
发布日期：__2020-05-22__ 

* 调整气泡关闭策略
* 调整客服弹窗文案

## SDK v2.32.0.9
发布日期：__2020-05-15__ 

* 调整气泡显示策略
* 调整onUserAccountLogout接口参数

## SDK v2.32.0.6
发布日期：__2020-05-09__ 

* 优化个人中心页面功能排序
* 调整部分网页加载超时时间

## SDK v2.32.0.4
发布日期：__2020-05-08__ 

* 新增一键登录功能
* 优化未实名用户防沉迷机制
* 修复已知问题

## SDK v2.31.0.8
发布日期：__2020-04-16__ 

* 新增一键登录功能
* 新增同步游戏身份信息功能
* 修复已知问题

## SDK v2.30.0.33
发布日期：__2019-12-27__ 

* 调整防沉迷计时策略
* 手动实名认证新增cancel方法
* 修复已知问题

## SDK v2.30.0.28

发布日期：__2019-12-18__ 

* 新增防沉迷功能
* 修复已知问题

## SDK v2.29.0.0

* 兼容Android Q
* 修复退出弹窗、悬浮球闪退

## SDK v2.28.0.10

* 优化实名认证弹窗事件
* 修复已知问题

## v2.28.0.9

* 新增数美开关
* 新增身份信息认证
* 优化多次调用登录方法流程
* 修复已知问题

## v2.27.0.4

* 修复初始化问题

## v2.27.0.3

* 调整游戏渠道号读取流程
* 替换移动、联通、电信、骏卡四个渠道号
* 替换支付宝jar包版本
* 新增卡类充值面额差异提示
* 修复已知问题

## v2.26.0.8

* 修复快速双击登录获取返回值失败
* 修复已知问题

## v2.26.0.3

* 修复悬浮球关闭区域返回首页显示问题
* 修复已知问题

## v2.26.0.2

* 修改登录验证及助手页超时时间
* 修复已知问题

## v2.26.0.1

* 游戏盒跳转新增game_key字段
* 不混淆jar包里面的WechatLoginHandler类

## v2.26.0.0

* 不混淆游戏盒aidl
* 修复无法关闭悬浮球

## v2.25.0.2

* 修复demo由于资源引用问题带来的奔溃

## v2.25.0.1

* 新增Android8.0权限REQUEST_INSTALL_PACKAGES
* 修复已知问题


## v2.25.0.0

* 数据请求方式改成https
* 修复游戏圈不存在问题
* 修复Android8.0/9.0兼容问题

## v2.24.0.5

* 在libs文件夹中新增多个.so文件
* 兼容Android 8.0

## v2.24.0.4

* 联通短代升级

## v2.23.0.4

* 修复资源文件中硬编码的问题
* 删除无用的资源文件

## v2.23.0.3

* 增加登录防刷验证
* 修复游戏助手页面有视频情况下的崩溃bug
* 修复切换账号崩溃的偶发性bug
* 可展示和领取多张延时优惠券
* 优惠券列表页面ui调整
* 增加跳转到游戏盒评论页面的接口，详情看接口文档


## v2.21.0.1

* 修复showGameForum(Activity activity) 接口的bug（已安装游戏盒却无法跳转到游戏圈）

## v2.21.0.0

* 增加支付宝吱口令领取红包提醒
* 退出弹窗，点击礼包增加toast提示暂无礼包

## v2.20.2.1

* 充值帮主页面增加充值qq客服
* 个人主页qq客服文案调整
* 修复部分bug


## v2.20.1.1

* 修复android系统7.0及以上版本强更崩溃的bug
* 调整客服qq的启动方式，无需添加好友即可聊天
* 修复部分bug，优化代码

## v2.20.0.3

* 增加联系客服入口开关，后台可控制
* 个人首页增加动态和问答的未读提示


## v2.19.1.3

* 修复游戏环境下打包，资源格式报错的bug

## v2.19.1.2

* 增加联系客服功能
* 修复部分bug，优化代码


## v2.19.0.1

* 增加打开游戏圈帖子详情接口，详情请看接口文档
* 退出弹窗布局调整，增加游戏圈、礼包、攻略入口
* 个人首页增加动态和问答内容
* 优化截屏后的提示层


## v2.18.0.1

* 修复下载非游戏应用，提示错误问题
* 修复登录页面崩溃的偶发性bug
* 增加对截屏事件的范围限制，降低非手动截屏情况下分享提示框弹出的概率

## v2.18.0.0

* 增加web登录页面上微信登录方式的支持

## v2.17.2.1

* 充值界面，只要选择短信充值方式，都在金额后面添加“（不含通信费）”文案
* 短信渠道界面，金额后面添加“（不含通信费）”文案
* 调整短信渠道界面布局

## v2.17.2.0

* 充值界面，如果充值渠道选择电信爱动漫，则金额后面增加“（不含通信费）”文案
* 调整优惠券倒计时结束的提示横幅，可点击其他控件而不影响提示
* 修复部分崩溃的bug

## v2.17.1.8

* 修复登录页面偶发性的崩溃bug
* 修复未安装微信，选择任意支付方式都弹出尚未安装微信提示的bug

## v2.17.1.6

* 修复小屏幕下充值渠道弹窗布局问题
* 修复创建浮球崩溃的偶发性bug
* 优化充值界面进程被杀后的提示


## v2.17.1.5

* 修复部分偶发性bug
* 选择微信qq钱包充值后，跳转到倒计时获取充值结果的页面，倒计时结束后才跳转到充值结果页
* 优化截屏功能

## v2.17.1.4

* 若使用sdk未进行初始化或者初始化还未结束，调用各个接口，会在日志提示"not init or sdk process is killed..."
* 在各个页面都加入进程被杀的判断，并统一弹出“页面过期”的判断（除了登录页面）
* 修复wap登录页面、激活页面、从退出弹窗进入游戏盒下载页面超时会崩溃的bug；
* 修复部分网络异常界面点击重新加载会崩溃的bug
* 优化代码，修复各种偶发性崩溃的bug

## v2.17.1.0

* 充值相关界面优化
* 浮球的浮白锁定文案调整为“锁定后不影响操作，再次长按可解锁”
* 优化代码，修复游戏方统计的部分偶发性闪退bug

## v2.16.1.0

* 增加手动截屏分享功能（此功能需要运营配置和开启，开关与首页进去的截图分享是同一个开关）
* 增加京东支付功能
* 增加web页面超时机制
* 调整身份认证框文案
* 修复充值首页直接关闭不会回调的bug
* 修改manifest中acitivity的theme，请查看接口文档

## v2.15.0.6

* 遇到ssl认证问题，弹出确认框，让用户选择是否继续
* 悬浮球和个人中心新增“游戏服务器延迟状态实时显示”功能（此功能需要运营配置和开启）
* 增加截图分享功能，5.0以上可截图分享，5.0以下选择系统图片后分享（此功能需要运营配置和开启，若分享到游戏盒需要保证游戏盒版本在3.6及以上）
* 修复支付测试模式下，不正确的结果返回


## v2.14.0.4

* 调整充值流程

## v2.13.1.3
* 修复首页崩溃的bug
* 修复在个人中心切换账号后充值过程中账号失效的bug
* 首页设置图标调整、布局优化
* manifest文件中UserCenterActivity的配置加上 android:screenOrientation="behind"
* manifest中所有的Activity配置加上android:screenOrientation="behind"

## v2.13.1.1

* 升级联通wo+短代渠道

## v2.13.0.9

* 悬浮球重构，去掉展开的小球，小球的内容放在点击悬浮球进去的页面
* 增加悬浮球操作浮白提示、消息浮白提示、自定义通知浮白提示
* 个人中心页面重构，该页面分为“4399游戏助手”和“个人中心”等页面
* 调整身份认证切换账号逻辑（原先只要点了切换账号，就会退出当前账号，改为只有切换成功才会退出当前账号）
* 初始化接口有调整，具体请看接口文档
* 短代支付SDK升级
* 页面优化，如加载过程中的加载框替换为进度条

## v2.12.1.5

* 修复个人中心，绑定完手机之后崩溃的bug
* 修复个人中心，绑定完手机，点击手机返回键崩溃的bug


## v2.12.1.4

* 新增优惠券相关功能
* 新增vip专属客服相关功能
* 个人中心页面界面调整
* 新增充值流程年龄、金额、身份认证判断
* 调整登录后身份认证显示界面和流程（先弹出提示框，引导前往身份认证框）
* 修复部分机型未安装微信的情况下启动微信h5支付崩溃的bug



## v2.11.0.9

* 如果未安装微信，启动微信支付，增加toast提醒
* 修复检查登录状态和微信h5充值的两个bug

## v2.11.0.7

* 新增绑定手机接口
* 新增身份验证功能（sdk后台可以控制是否开启）
* 新增激活游戏功能（sdk后台可以控制是否开启）
* wo+和优易付充值页面显示公司名称
* wap注册页面修改：增加注册协议的、增加绑定身份证的提示（sdk后台可以控制是否开启，与2一样的开关）
* manifest增加了两个activity的配置，请查看接口文档
* 修复欢迎语点击无法消失的bug
* 新增“检查手机绑定状态”接口，该接口是异步的，具体请看接口文档



## v2.10.0.2    

发布日期: __2016-09-21__   

* 悬浮窗子项可以根据需要在后台配置，最多不超过6个  

* 悬浮窗中增加视频入口（有视频的游戏可以联系运营开启）  

* 针对玩家充值问题，悬浮窗增加“意见反馈”快速入口  

* 增加用户登录后提示用语，并可在后台配置  

* 新增微信H5渠道（旧版SDK渠道仍然可以使用一段时间）  

* 调整QQ钱包充值的部分流程，和文案  




## v2.9.0.3    

发布日期: __2016-08-22__   

* 替换fragment里的getContext方法，增加兼容性

* 修复非首次初始化收不到回调的问题




## v2.9.0.2  

发布日期: __2016-08-04__  

* 新增QQ钱包充值渠道（此渠道在v2.9.0.0或更高版本上默认开启） 




## v2.8.0.2  

发布日期: __2016-07-04__  

* 新增银联渠道（替代原网银渠道）  

* 修复重复初始化导致的个别游戏不能显示充值渠道的问题  

* 修复通过悬浮窗跳转游戏盒界面，Home键切到桌面，再回到游戏不显示之前界面的问题  

* 升级android-support-v13包，目前版本为v23.2.1  

* 增加对android 6.0系统API和运行时权限的支持  




**注意：为了兼容5.0、6.0系统，更新了AndroidManifest和Proguard，所有的jar包合并成一个jar包**




## v2.7.1.0

发布日期: __2016-05-12__




- 升级短代渠道：  

1、增加多套计费代码支持  

2、修改小bug，优化日志功能  




- 移除Activity的singletask模式设置

- 升级图片加载库，修复空指针问题  

- 升级支付宝SDK：v15.0.8




## v2.7.0.3

发布日期：__2016-01-22__

- 接入优易付短代渠道，支持移动、联通、电信三网支付

注意：新渠道暂时没有默认开启，如需开启，请通知运营同事; 若接入新渠道，请对照Demo重新配置AndroidManifest文件和

混淆文件。具体可以参考接入文档。




- 优化增量更新，优化增量包合并过程，避免解析包错误的情况

- 在用户中心页面（Web登录、修改密码、绑定手机）增加Web链接被劫持的处理

- 修复个别设备因SDK不能创建目录导致的微信支付组件不能更新的问题




## v2.6.0.4

发布日期：__2015-10-30__

- 增加微信充值渠道，所有游戏均可接入  

**注意：本次更新需要将Demo的assets目录下的m4399SecurityIab.apk拷贝到游戏工程assets

下面，其他接口及配置没有变化**




- 更新联通短代，去除对验证码位数的限制

- 修复一些bug




## v2.5.1.1

发布日期：__2015-10-13__

- 修改“我的订单”页面为“未完成订单”，只显示未完成和失败订单  

- “维护提示弹窗”的右上角关闭按钮改为在后台配置是否显示  

- “检查更新失败”弹窗：显示“退出游戏”和”“重新更新”  

- 升级联动优势两个渠道，增加验证码验证  

- 修复一些bug




## v2.5.0.0

发布日期：__2015-08-15__

- 联通短代升级，并重新上线

- 移动短代新增“联动优势”渠道

- 升级android-support-v13.jar

- 优化下微信支付渠道

- 优化退出对话框

- 修复一些bug




**注意：微信支付目前仅支持少量游戏，其他游戏不会配置微信渠道，

但我们将会很快支持所有游戏的接入。**




## v2.4.3.0

发布日期: __2015-07-20__

- 新增微信支付功能

- 修复一些bug




**注意：微信支付接入流程比较复杂，需要一些操作**  

1.在微信开放平台注册游戏APK包名，生成APP_ID  

2.使用微信开放平台提供的工具生成APK的sign值，并填入开放平台  

3.接入4399SDK，要更新AndroidManefest.xml中的配置  

4.添加回调Activity  

- 创建(游戏包名.wapi)的包路径，比如org.yjmobile.zmxy.wxapi；

- 将WXPayEntryActivity.java拷贝到下面

- 用开放平台生成的APP_ID更新文件中的相应字段

注意：不要修改包路径和Activity名字（微信SDK已经写死了，修改会导致没有回调结果）




Demo不能直接打开微信，需要配置一些参数，若需要接入或者测试请联系运营人员




## v2.4.2.1

发布日期：__2015-06-16__

- 增加短代退费功能

- 升级支付宝

- 修复Android 5.x上服务不能隐式启动问题

- 修复其他bug

- **本次更新AndroidManifest中有所更新，请务必同步配置**




## v2.4.0.5

发布日期：__2015-04-25__  

- 悬浮窗->个人中心,消息中心和投诉咨询页面的优化与完善

- 悬浮窗新增“发现”入口，原“关闭”入口移到“个人中心”

- 增加4399用户中心维护的提示功能，以在用户中心宕机的情况下给用户友好提示

- 优化未安装游戏盒时的弹窗提示

- 充值界面首页增加“历史订单”入口，以查看近期订单

- 修复之前版本的一些bug







## v2.3.0.4

发布日期：__2015-02-05__  

- 运营配置OperateCenterConfig更新  

  去除setGameName()接口，游戏名读取服务端配置，  

  去除setTestRecharge()接口，改为充值审核模式，模式调控由游戏后台完成，  

  去除setGameChannel()接口，改为读取渠道配置文件的方式，若需要打渠道包可咨询运营人员  

  [客户端文档](/Document/ClientDocument.md#%E5%88%9D%E5%A7%8B%E5%8C%96)中列举的配置是所有可用配置的示例

- 充值审核模式取代测试模式，并在后台控制该模式的状态，详情咨询运营相关人员  

- 支付宝升级，并进一步完善充值流程，修复某些机器上“取消”充值会Crash的问题  

- 悬浮窗->个人中心，新增投诉入口，详情参考Demo  

- 悬浮窗->个人中心，新增消息推送功能，详情咨询运营相关人员  

- 增量更新优化，优化了更新日志的显示和检查更新失败的处理流程  

- 修复之前版本的一些bug




## v2.2.0.2

发布日期：__2014-12-22__

- 新增短代渠道

- 移动短代策略调整

- 优化悬浮窗弹窗结构，改为扇形，优化弹窗动画

- 合并登出和个人中心里帐号切换接口到初始化的全局接口里

- 修复先前发布版本中已知的bug







## v2.1.1.13

发布日期：__2014-11-22__

- 没有游戏圈时增加弹框







## v2.1.1.12

发布日期：__2014-11-21__

- 增加充值测试模式

- 增加游戏退出接口

- 优化增量更新

- 扩充mark字段，新增支持'|'、'-'、'_'字符

- 充值接口金额改为整型

- 增加4399游戏盒官网、攻略、礼包3个入口

- 优化SDK初始化逻辑，加快初始化速度，修正了部分游戏启动时黑屏的bug  







## v2.1.0.4  

发布日期：__2014-10-14__  

- 修正配置中关闭游戏圈时，游戏启动是崩溃异常    







## v2.1.0.2  

发布日期：__2014-10-13__  

- 更换移动短代运营商  

- 新增悬浮窗样式选择  

- 修正2.0.0中隐藏按钮BUG  

- 增加个人中心  

- 增加4399游戏盒授权、游戏圈    

- 重构充值UI  







## v2.0.0  

发布日期：__2014-9-28__  

- 更新支付宝SDK2.0  

- 增加悬浮窗  

- 增加增量更新  

- 增加个人中心  

- 增加4399游戏盒授权、游戏圈    

- 重构充值UI  

